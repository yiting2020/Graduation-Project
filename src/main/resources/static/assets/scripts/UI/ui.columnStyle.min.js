(function(){if(!window.ui)window.ui={};function e(e){return e<10?"0"+e:""+e}function t(e,t){if(!e){e=""}if(!$.isNumeric(t))return null;return"<span>"+ui.str.formatMoney(t,e)+"</span>"}window.ui.ColumnStyle={cnfn:{columnCheckboxAll:function(e){var t=$("<input class='gridview-check-all' type='checkbox' />");t.prop("name",e.column+"_all");t.on("change",$.proxy(this.onAllSelected,this));this.columnStateFunctions.checkboxAllCancel=function(){t.prop("checked",false);this._checkedCount=0};return t},columnText:function(e){var t=$("<span />");var n=e.text;if(n==undefined||n==null)n="";t.text(n);return t},empty:function(){return null}},cfn:{defaultText:function(e,t){var n=e+"",r=null;if(n==="undefined"||n==="null"||n==="NaN")return null;r=$("<span />");r.text(e);return r},empty:function(e,t){return null},rowNumber:function(e,t,n){if(e==="no-count"){return null}var r=$("<span />");var i=(this.pageIndex-1)*this.pageSize+(n+1);r.text(i);return r},createCheckbox:function(e,t){var n=$("<input class='gridview-check' type='checkbox' />");n.prop("name",t.column+"");n.val(e);this.prepareRowCheckboxChangeHandler();return n},formatParagraph:function(e,t){var n=$("<p />");n.text(e);return n},formatDate:function(t,n){var r=t;if(!r){return null}if(typeof r==="string"){r=ui.str.jsonToDate(r)}var i=$("<span />");if(!isNaN(r)){i.text([r.getFullYear(),"-",e(r.getMonth()+1),"-",e(r.getDate())].join(""))}else{i.text("无法转换")}return i},formatDateTime:function(t,n){var r=t;if(!r){return null}if(typeof r==="string"){r=ui.str.jsonToDate(r)}var i=$("<span />");if(!isNaN(r)){i.text([r.getFullYear(),"-",e(r.getMonth()+1),"-",e(r.getDate())," ",e(r.getHours()),":",e(r.getMinutes()),":",e(r.getSeconds())].join(""))}else{i.text("无法转换")}return i},formatTime:function(t,n){var r=t;if(!r){return null}if(typeof r==="string"){r=ui.str.jsonToDate(r)}var i=$("<span />");if(!isNaN(r)){i.text([e(r.getHours()),":",e(r.getMinutes()),":",e(r.getSeconds())].join(""))}else{i.text("无法转换")}return i},money:function(e,n){return t("￥",e)},cellPhoneNumber:function(e,t){if(!e){return}var n=$("<span />");if(e.length==11){n.text(e.substring(0,3)+"-"+e.substring(3,7)+"-"+e.substring(7))}else{n.text(e)}return n},rowSpanSame:function(e,t,n,r){var i=null;if(n==0){i=this["__temp$TdContext_"+t.column]={rowSpan:1,content:e,td:r}}else{i=this["__temp$TdContext_"+t.column];if(i.content!=e){i.rowSpan=1;i.content=e;i.td=r}else{i.rowSpan++;i.td.prop("rowSpan",i.rowSpan);r.isAnnul=true;return null}}var a=$("<span />").text(e);return a}},cfnp:{getFormatBoolean:function(e,t,n){e+="";t+="";if(arguments.length==2)n="";var r=16;var i=r*e.length||r,a=r*t.length||r;var s=function(r,s){var u=$("<span />");if(r===true){u.addClass("state-text").addClass("state-true").css("width",i+"px");u.text(e)}else if(r===false){u.addClass("state-text").addClass("state-false").css("width",a+"px");u.text(t)}else{u.text(n)}return u};return s},getFormatNumber:function(e){return function(t,n){if(!$.isNumeric(t)){return null}var r=$("<span />");r.text(ui.str.numberFormatScale(t,e));return r}},getFormatMoney:function(e){return function(n,r){return t(e,n)}},getProgressBar:function(e,t){if(!$.isNumeric(e)||e<60){e=false}var n=162;if(!$.isNumeric(t)){t=null}else if(t<1){t=null}var r=new Error("column.len或width设置太小，无法绘制进度条！");var i=function(i,a,s){var u=$("<div class='progress-panel' />");var o=$("<div class='progress-bar' />");var l;if(e){l=e}else if($.isNumeric(a.len)){l=a.len-12}else{l=n}l-=52;if(l<=0){throw r}o.css("width",l+"px");var c,f;if($.isNumeric(i[0])){c=i[0];f=t||i[1]}else{c=i;f=t}if(!$.isNumeric(f)){f=c}if(f==0){f=1}if(!$.isNumeric(c)){c=0}var p=c/f;l=p*l;var d=$("<div class='progress-value background-highlight' />");d.css("width",l+"px");o.append(d);u.append(o);var g=p*100+"";if(g==="NaN"){g="0"}var h=g.indexOf(".");if(h==-1){g+=".0%"}else{var v=g.length-h-1;if(v==0){g+="0%"}else if(v>1){g=g.substring(0,h+2)+"%"}else{g+="%"}}var m=$("<div class='progress-text font-highlight'/>");var x=$("<span>"+g+"</span>");m.append(x);u.append(m);var w=$('<div style="clear:both;" />');u.append(w);return u};return i},getRowspanColumn:function(e,t,n){var r="__temp$TdContext_"+t;return function(t,i,a,s){var u=null;if(a==0){u=this[r]={rowSpan:1,content:t,td:s}}else{u=this[r];if(u.content[e]!=t[e]){u.rowSpan=1;u.content=t;u.td=s}else{u.rowSpan++;u.td.prop("rowSpan",u.rowSpan);s.isAnnul=true;return null}}return n.apply(this,arguments)}},getImage:function(e,t,n,r){if(ui.core.type(e)!=="number"||e<=0){e=120}if(ui.core.type(t)!=="number"||e<=0){t=90}if(!n){n=""}n+="";if(!ui.images){throw ui.error("require ui.images.js")}var i=ui.images.createImageZoomer({getNext:function(e){var t=this.target;var n=t.parent().parent();var r=n.parent();var i=r.parent();var a=i[0].rows.length;var s=r[0].rowIndex+e;var u=null;do{if(s<0||s>=a){return false}u=$(i[0].rows[s].cells[n[0].cellIndex]).children();t=u.children("img");s+=e}while(u.hasClass("failed-image"));return t},onNext:function(){return this.option.getNext.call(this,1)||null},onPrev:function(){return this.option.getNext.call(this,-1)||null},hasNext:function(){return!!this.option.getNext.call(this,1)},hasPrev:function(){return!!this.option.getNext.call(this,-1)}});return function(a,s,u,o){if(!a){return"<span>暂无图片</span>"}var l=$("<div class='grid-small-image' style='overflow:hidden;' />");var c=$("<imgs style='cursor:crosshair;' />");l.css({width:e+"px",height:t+"px"});l.append(c);c.setImage(n+a,e,t).then(function(e){c.addImageZoomer(i)},function(e){c.attr("alt","请求图片失败");if(r){c.prop("src",r);c.addClass("default-image")}l.addClass("failed-image")});return l}}}}})();